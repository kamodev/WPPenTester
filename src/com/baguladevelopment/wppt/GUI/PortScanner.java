package com.baguladevelopment.wppt.GUI;

// Include all the pacckages needed for this class
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.net.*;
import javax.swing.JButton;
import javax.swing.JPanel;
import javax.swing.JTable;
import javax.swing.JInternalFrame;

public class PortScanner extends JInternalFrame implements ActionListener
{

    // Constructor
    public PortScanner()
    {
        this.setTitle("Port Scanner");
        this.setClosable(true);
        this.setDefaultCloseOperation(JInternalFrame.DISPOSE_ON_CLOSE);
        this.setResizable(false);
        this.setIconifiable(true);
        this.setSize(400, 400);
        this.setVisible(true);
        
        // Base UI panels
        JPanel panel1 = new JPanel();
        JPanel panel2 = new JPanel();
        
        // Table for the messages to go to
        JTable msgTable = new JTable();
               //msgTable.setColumnModel(null);
        
        JButton btnStart = new JButton("Start");
                btnStart.addActionListener(this);
                btnStart.setActionCommand("start");
        
        // Add components to the panels
        panel1.add(msgTable);
        panel2.add(btnStart);
        
        // Add the panels to the window
        this.add(panel1);
        this.add(panel2);

    }

    // Scan the server for open ports
    public void scan()
    {
        if (isPortActive("127.0.0.1", 80))
        {
            System.out.println("Server 127.0.0.1 has Port 80 active!");
        }
        else if (isPortActive("10.34.162.38", 80))
        {
            System.out.println("Server 10.34.162.38 has Port 80 active!");
        }
        else
        {
            System.out.println("Server 127.0.0.1 does not have Port 80 active!");
            System.out.println("OR");
            System.out.println("Server 10.34.162.38 does not have Port 80 active!");
        }
    }

    //    Check to see if the port is active
    private boolean isPortActive(String target, int port)
    {
        // All method based base types
        boolean isActive = false;

        // All method based objects
        Socket skt = null;

        try
        {
            skt = new Socket(target, port);
            skt.close();
            isActive = true;
        }
        catch(Exception ex)
        {
            System.out.println("Server does not have Port 80 active!");
        }

        return isActive;
    }

    // All the action for the program run through here
    @Override
    public void actionPerformed(ActionEvent e)
    {
        switch(e.getActionCommand())
        {
            case "start":
                this.scan();
                break;
        }
    }
}
